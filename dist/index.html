<!DOCTYPE html><html lang="it"> <head><meta charset="UTF-8"><title>Tabella Dati</title><meta name="description" content="Visualizza i dati dal Google Sheet tramite Worker process."><meta property="og:title" content="Tabella Dati"><meta property="og:description" content="Visualizza i dati dal Google Sheet tramite Worker process."><!-- Bootstrap CSS --><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"><!-- DataTables CSS --><link href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" rel="stylesheet"></head> <body class="container mt-5"> <h1>Tabella Dati</h1> <table id="sheetTable" class="table table-striped"> <thead> <tr id="headerRow"></tr> </thead> <tbody id="bodyRows"></tbody> </table> <!-- jQuery + DataTables + Bootstrap JS --> <script type="module">document.addEventListener("DOMContentLoaded",async function(){try{const t=await(await fetch("{apiUrl}")).json();if(t.length>0){const d=document.getElementById("headerRow");Object.keys(t[0]).forEach(n=>{const e=document.createElement("th");e.textContent=n,d.appendChild(e)});const c=document.getElementById("bodyRows");t.forEach(n=>{const e=document.createElement("tr");Object.values(n).forEach(r=>{const a=document.createElement("td");a.textContent=r,e.appendChild(a)}),c.appendChild(e)}),$("#sheetTable").DataTable()}else document.getElementById("sheetTable").insertAdjacentHTML("afterend","<p>Nessun dato disponibile</p>")}catch(o){console.error("Errore nel fetch:",o),document.getElementById("sheetTable").insertAdjacentHTML("afterend","<p>Errore nel caricamento dati</p>")}});</script> <script type="module" src="/_astro/index.astro_astro_type_script_index_1_lang.CL9_Na5a.js"></script> <script type="module" src="/_astro/index.astro_astro_type_script_index_2_lang.C8-AfyOb.js"></script> <script type="module" src="/_astro/index.astro_astro_type_script_index_3_lang.Ckmd0dW3.js"></script> <script type="module" src="/_astro/index.astro_astro_type_script_index_4_lang.CkbqmuSl.js"></script> </body> </html>